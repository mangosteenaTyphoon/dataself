# OKR-Todo API 测试用例

## 📋 测试概述

本文档包含 OKR-Todo 系统所有 API 接口的完整测试用例，共 20 个接口，60 个测试用例。

---

## 🔧 测试环境

### 基础配置
- **服务地址**：`http://localhost:8084`
- **Swagger 文档**：`http://localhost:8084/swagger-ui.html`
- **API 前缀**：无（直接访问 `/goal`, `/task`, `/statistics`）

### 认证配置
- **认证方式**：Bearer Token（如需要）
- **Token 获取**：通过登录接口获取
- **Token 格式**：`Authorization: Bearer {token}`

---

## 📊 测试用例统计

| 模块 | 接口数 | 测试用例数 | 优先级 |
|------|--------|-----------|--------|
| 目标管理 | 8 | 24 | P0 |
| 任务管理 | 9 | 27 | P0 |
| 统计分析 | 3 | 9 | P1 |
| **总计** | **20** | **60** | - |

---

## 1️⃣ 目标管理接口测试（8个接口，24个用例）

### 1.1 分页查询目标列表

**接口信息**
- **URL**：`GET /goal/pageQuery`
- **权限**：`todo:goal:list`

**测试用例**

| 用例ID | 用例名称 | 请求参数 | 预期结果 | 优先级 |
|--------|---------|---------|---------|--------|
| TC-G-001 | 查询所有目标 | `pageNum=1&pageSize=10` | 返回目标列表，状态码200 | P0 |
| TC-G-002 | 按状态筛选 | `status=IN_PROGRESS` | 返回进行中的目标 | P0 |
| TC-G-003 | 按优先级筛选 | `priority=HIGH` | 返回高优先级目标 | P1 |

---

### 1.2 查询目标详情

**接口信息**
- **URL**：`GET /goal/{goalId}`
- **权限**：`todo:goal:query`

**测试用例**

| 用例ID | 用例名称 | 请求参数 | 预期结果 | 优先级 |
|--------|---------|---------|---------|--------|
| TC-G-004 | 查询存在的目标 | `goalId=1` | 返回目标详情，状态码200 | P0 |
| TC-G-005 | 查询不存在的目标 | `goalId=999999` | 返回错误信息，状态码404 | P1 |
| TC-G-006 | 无权限查询 | `goalId=2`（其他用户） | 返回权限错误，状态码403 | P0 |

---

### 1.3 新增目标

**接口信息**
- **URL**：`POST /goal`
- **权限**：`todo:goal:add`

**测试用例**

| 用例ID | 用例名称 | 请求体 | 预期结果 | 优先级 |
|--------|---------|--------|---------|--------|
| TC-G-007 | 正常新增目标 | 完整的目标信息 | 创建成功，返回目标ID | P0 |
| TC-G-008 | 缺少必填字段 | 缺少title | 返回参数校验错误 | P0 |
| TC-G-009 | 字段长度超限 | title超过200字符 | 返回参数校验错误 | P1 |

**请求示例**
```json
{
  "title": "2026年Q1技术提升目标",
  "description": "提升Java和微服务架构能力",
  "priority": "HIGH",
  "expectedStartTime": "2026-01-01 00:00:00",
  "expectedEndTime": "2026-03-31 23:59:59",
  "tags": "技术,学习"
}
```

---

### 1.4 编辑目标

**接口信息**
- **URL**：`PUT /goal`
- **权限**：`todo:goal:edit`

**测试用例**

| 用例ID | 用例名称 | 请求体 | 预期结果 | 优先级 |
|--------|---------|--------|---------|--------|
| TC-G-010 | 正常编辑目标 | 修改title和description | 更新成功 | P0 |
| TC-G-011 | 编辑不存在的目标 | goalId=999999 | 返回错误信息 | P1 |
| TC-G-012 | 编辑已归档的目标 | status=ARCHIVED | 返回业务错误 | P1 |

---

### 1.5 删除目标

**接口信息**
- **URL**：`DELETE /goal/{goalIds}`
- **权限**：`todo:goal:remove`

**测试用例**

| 用例ID | 用例名称 | 请求参数 | 预期结果 | 优先级 |
|--------|---------|---------|---------|--------|
| TC-G-013 | 删除单个目标 | `goalIds=1` | 删除成功 | P0 |
| TC-G-014 | 批量删除目标 | `goalIds=1,2,3` | 批量删除成功 | P0 |
| TC-G-015 | 删除不存在的目标 | `goalIds=999999` | 返回错误信息 | P1 |

---

### 1.6 开始目标

**接口信息**
- **URL**：`POST /goal/start/{goalId}`
- **权限**：`todo:goal:edit`

**测试用例**

| 用例ID | 用例名称 | 请求参数 | 预期结果 | 优先级 |
|--------|---------|---------|---------|--------|
| TC-G-016 | 开始未开始的目标 | `goalId=1` | 状态变为IN_PROGRESS，记录开始时间 | P0 |
| TC-G-017 | 开始已开始的目标 | `goalId=1` | 返回业务错误 | P1 |
| TC-G-018 | 开始已完成的目标 | `goalId=1` | 返回业务错误 | P1 |

---

### 1.7 完成目标

**接口信息**
- **URL**：`POST /goal/complete/{goalId}`
- **权限**：`todo:goal:edit`

**测试用例**

| 用例ID | 用例名称 | 请求参数 | 预期结果 | 优先级 |
|--------|---------|---------|---------|--------|
| TC-G-019 | 完成进行中的目标 | `goalId=1&summary=完成总结` | 状态变为COMPLETED，计算得分 | P0 |
| TC-G-020 | 完成未开始的目标 | `goalId=1` | 返回业务错误 | P1 |
| TC-G-021 | 完成时任务未全部完成 | `goalId=1` | 返回业务错误 | P0 |

---

### 1.8 归档目标

**接口信息**
- **URL**：`POST /goal/archive/{goalId}`
- **权限**：`todo:goal:edit`

**测试用例**

| 用例ID | 用例名称 | 请求参数 | 预期结果 | 优先级 |
|--------|---------|---------|---------|--------|
| TC-G-022 | 归档已完成的目标 | `goalId=1` | 状态变为ARCHIVED | P0 |
| TC-G-023 | 归档未完成的目标 | `goalId=1` | 返回业务错误 | P1 |
| TC-G-024 | 归档已归档的目标 | `goalId=1` | 返回业务错误 | P1 |

---

## 2️⃣ 任务管理接口测试（9个接口，27个用例）

### 2.1 分页查询任务列表

**接口信息**
- **URL**：`GET /task/pageQuery`
- **权限**：`todo:task:list`

**测试用例**

| 用例ID | 用例名称 | 请求参数 | 预期结果 | 优先级 |
|--------|---------|---------|---------|--------|
| TC-T-001 | 查询所有任务 | `pageNum=1&pageSize=10` | 返回任务列表，状态码200 | P0 |
| TC-T-002 | 按目标ID筛选 | `goalId=1` | 返回指定目标的任务 | P0 |
| TC-T-003 | 按状态筛选 | `status=COMPLETED` | 返回已完成的任务 | P1 |

---

### 2.2 查询任务详情

**接口信息**
- **URL**：`GET /task/{taskId}`
- **权限**：`todo:task:query`

**测试用例**

| 用例ID | 用例名称 | 请求参数 | 预期结果 | 优先级 |
|--------|---------|---------|---------|--------|
| TC-T-004 | 查询存在的任务 | `taskId=1` | 返回任务详情，状态码200 | P0 |
| TC-T-005 | 查询不存在的任务 | `taskId=999999` | 返回错误信息，状态码404 | P1 |
| TC-T-006 | 无权限查询 | `taskId=2`（其他用户） | 返回权限错误，状态码403 | P0 |

---

### 2.3 查询目标下的任务

**接口信息**
- **URL**：`GET /task/goal/{goalId}`
- **权限**：`todo:task:list`

**测试用例**

| 用例ID | 用例名称 | 请求参数 | 预期结果 | 优先级 |
|--------|---------|---------|---------|--------|
| TC-T-007 | 查询有任务的目标 | `goalId=1` | 返回任务列表 | P0 |
| TC-T-008 | 查询无任务的目标 | `goalId=2` | 返回空列表 | P1 |
| TC-T-009 | 查询不存在的目标 | `goalId=999999` | 返回错误信息 | P1 |

---

### 2.4 新增任务

**接口信息**
- **URL**：`POST /task`
- **权限**：`todo:task:add`

**测试用例**

| 用例ID | 用例名称 | 请求体 | 预期结果 | 优先级 |
|--------|---------|--------|---------|--------|
| TC-T-010 | 正常新增任务 | 完整的任务信息 | 创建成功，返回任务ID | P0 |
| TC-T-011 | 缺少必填字段 | 缺少goalId | 返回参数校验错误 | P0 |
| TC-T-012 | 目标不存在 | goalId=999999 | 返回业务错误 | P1 |

**请求示例**
```json
{
  "goalId": 1,
  "title": "学习Spring Boot 3.x新特性",
  "description": "深入学习Spring Boot 3.x的新特性和最佳实践",
  "priority": "HIGH",
  "expectedStartTime": "2026-01-01 00:00:00",
  "expectedEndTime": "2026-01-15 23:59:59",
  "sortOrder": 1
}
```

---

### 2.5 编辑任务

**接口信息**
- **URL**：`PUT /task`
- **权限**：`todo:task:edit`

**测试用例**

| 用例ID | 用例名称 | 请求体 | 预期结果 | 优先级 |
|--------|---------|--------|---------|--------|
| TC-T-013 | 正常编辑任务 | 修改title和description | 更新成功 | P0 |
| TC-T-014 | 编辑不存在的任务 | taskId=999999 | 返回错误信息 | P1 |
| TC-T-015 | 编辑已完成的任务 | status=COMPLETED | 返回业务错误 | P1 |

---

### 2.6 删除任务

**接口信息**
- **URL**：`DELETE /task/{taskIds}`
- **权限**：`todo:task:remove`

**测试用例**

| 用例ID | 用例名称 | 请求参数 | 预期结果 | 优先级 |
|--------|---------|---------|---------|--------|
| TC-T-016 | 删除单个任务 | `taskIds=1` | 删除成功，更新目标进度 | P0 |
| TC-T-017 | 批量删除任务 | `taskIds=1,2,3` | 批量删除成功 | P0 |
| TC-T-018 | 删除不存在的任务 | `taskIds=999999` | 返回错误信息 | P1 |

---

### 2.7 开始任务

**接口信息**
- **URL**：`POST /task/start/{taskId}`
- **权限**：`todo:task:edit`

**测试用例**

| 用例ID | 用例名称 | 请求参数 | 预期结果 | 优先级 |
|--------|---------|---------|---------|--------|
| TC-T-019 | 开始未开始的任务 | `taskId=1` | 状态变为IN_PROGRESS，记录开始时间 | P0 |
| TC-T-020 | 开始已开始的任务 | `taskId=1` | 返回业务错误 | P1 |
| TC-T-021 | 开始已完成的任务 | `taskId=1` | 返回业务错误 | P1 |

---

### 2.8 完成任务

**接口信息**
- **URL**：`POST /task/complete/{taskId}`
- **权限**：`todo:task:edit`

**测试用例**

| 用例ID | 用例名称 | 请求参数 | 预期结果 | 优先级 |
|--------|---------|---------|---------|--------|
| TC-T-022 | 完成进行中的任务 | `taskId=1&score=EXCELLENT&summary=完成总结` | 状态变为COMPLETED，更新目标进度 | P0 |
| TC-T-023 | 完成未开始的任务 | `taskId=1` | 返回业务错误 | P1 |
| TC-T-024 | 缺少评分参数 | `taskId=1&summary=完成` | 返回参数校验错误 | P0 |

---

### 2.9 标记未达成

**接口信息**
- **URL**：`POST /task/notAchieved/{taskId}`
- **权限**：`todo:task:edit`

**测试用例**

| 用例ID | 用例名称 | 请求参数 | 预期结果 | 优先级 |
|--------|---------|---------|---------|--------|
| TC-T-025 | 标记进行中的任务 | `taskId=1` | 状态变为NOT_ACHIEVED | P0 |
| TC-T-026 | 标记未开始的任务 | `taskId=1` | 返回业务错误 | P1 |
| TC-T-027 | 标记已完成的任务 | `taskId=1` | 返回业务错误 | P1 |

---

## 3️⃣ 统计分析接口测试（3个接口，9个用例）

### 3.1 获取目标统计

**接口信息**
- **URL**：`GET /statistics/goal`
- **权限**：`todo:statistics:query`

**测试用例**

| 用例ID | 用例名称 | 请求参数 | 预期结果 | 优先级 |
|--------|---------|---------|---------|--------|
| TC-S-001 | 查询目标统计 | 无 | 返回目标统计数据 | P0 |
| TC-S-002 | 无数据时查询 | 无 | 返回空统计数据 | P1 |
| TC-S-003 | 无权限查询 | 无 | 返回权限错误 | P0 |

**响应示例**
```json
{
  "code": 200,
  "msg": "操作成功",
  "data": {
    "totalCount": 10,
    "draftCount": 2,
    "notStartedCount": 1,
    "inProgressCount": 5,
    "completedCount": 2,
    "notAchievedCount": 0,
    "archivedCount": 0,
    "completionRate": 20.0,
    "averageScore": 85.5
  }
}
```

---

### 3.2 获取任务统计

**接口信息**
- **URL**：`GET /statistics/task`
- **权限**：`todo:statistics:query`

**测试用例**

| 用例ID | 用例名称 | 请求参数 | 预期结果 | 优先级 |
|--------|---------|---------|---------|--------|
| TC-S-004 | 查询任务统计 | 无 | 返回任务统计数据 | P0 |
| TC-S-005 | 无数据时查询 | 无 | 返回空统计数据 | P1 |
| TC-S-006 | 无权限查询 | 无 | 返回权限错误 | P0 |

**响应示例**
```json
{
  "code": 200,
  "msg": "操作成功",
  "data": {
    "totalCount": 50,
    "notStartedCount": 10,
    "inProgressCount": 25,
    "completedCount": 15,
    "notAchievedCount": 0,
    "completionRate": 30.0,
    "excellentCount": 5,
    "goodCount": 7,
    "qualifiedCount": 3,
    "poorCount": 0
  }
}
```

---

### 3.3 获取数据看板

**接口信息**
- **URL**：`GET /statistics/dashboard`
- **权限**：`todo:statistics:query`

**测试用例**

| 用例ID | 用例名称 | 请求参数 | 预期结果 | 优先级 |
|--------|---------|---------|---------|--------|
| TC-S-007 | 查询数据看板 | 无 | 返回完整的看板数据 | P0 |
| TC-S-008 | 无数据时查询 | 无 | 返回空看板数据 | P1 |
| TC-S-009 | 无权限查询 | 无 | 返回权限错误 | P0 |

**响应示例**
```json
{
  "code": 200,
  "msg": "操作成功",
  "data": {
    "goalStatistics": { ... },
    "taskStatistics": { ... },
    "recentGoals": [ ... ],
    "recentTasks": [ ... ]
  }
}
```

---

## 📝 测试执行说明

### 1. 测试前准备
1. 启动服务
2. 初始化数据库
3. 准备测试数据
4. 获取认证Token（如需要）

### 2. 测试执行顺序
1. 先执行 P0 优先级用例
2. 再执行 P1 优先级用例
3. 按模块顺序执行

### 3. 测试数据管理
- 每个测试用例使用独立的测试数据
- 测试完成后清理测试数据
- 避免测试数据相互影响

### 4. 测试结果记录
- 记录每个用例的执行结果
- 记录失败用例的错误信息
- 生成测试报告

---

## ⚠️ 注意事项

1. **权限测试**：确保测试用户已分配所有权限
2. **数据隔离**：使用独立的测试数据库
3. **并发测试**：注意并发测试可能影响数据一致性
4. **异常处理**：验证所有异常场景的错误提示
5. **性能测试**：关注接口响应时间

---

**文档版本**：v1.0.0  
**最后更新**：2026-01-11
